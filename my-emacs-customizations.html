<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Bastis Scratchpad On The Internet</title>
    <meta name="description" content="">
    <meta name="author" content="Bastian Bechtold">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="./theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="./theme/bootstrap.min.css" rel="stylesheet">
    <link href="./theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="./theme/local.css" rel="stylesheet">
    <link href="./theme/pygments.css" rel="stylesheet">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href=".">Bastis Scratchpad On The Internet</a>

        <div class="nav-collapse">
        <ul class="nav">
        
            
        
        
        
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
        
    <div class='article'>
        <div class="content-title">
            <h1>My Emacs customizations</h1>
            14/10/2012


by <a class="url fn" href="./author/bastian-bechtold.html">Bastian Bechtold</a>
 




        </div>
	
        <div><p>I don't host my <code>.emacs</code> in a repository. I tried it for a while, but it did not work for me. I think repos are great for managing multiple divergent versions of the same source tree. However, my dotfiles should never diverge, they should just be kept in sync. This is what Dropbox is great at. So I use Dropbox instead of git.</p>
<p>One downside of that is that it is not as easy to provide a public link to my dotfiles. Or maybe it is. Here goes</p>
<p><a href="https://dl.dropbox.com/s/0ne31wkur81wgzb/.emacs">My <em>.emacs</em></a></p>
<p>Now on to the meat of this post: Some customizations I made that I think are cool.</p>
<h2>When Emacs starts up, make it fit the left half of the screen</h2>
<p>First, I need a function to set the size of a frame in terms of pixels. Emacs only provides <code>set-frame-size</code>, but that works on characters, not pixels.</p>
<div class="codehilite"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">set-frame-pixel-size</span> <span class="p">(</span><span class="nv">frame</span> <span class="nv">width</span> <span class="nv">height</span><span class="p">)</span>
  <span class="s">&quot;Sets size of FRAME to WIDTH by HEIGHT, measured in pixels.&quot;</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">pixels-per-char-width</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nv">frame-pixel-width</span><span class="p">)</span> <span class="p">(</span><span class="nv">frame-width</span><span class="p">)))</span>
        <span class="p">(</span><span class="nv">pixels-per-char-height</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nv">frame-pixel-height</span><span class="p">)</span> <span class="p">(</span><span class="nv">frame-height</span><span class="p">))))</span>
    <span class="p">(</span><span class="nv">set-frame-size</span> <span class="nv">frame</span>
                    <span class="p">(</span><span class="nb">floor</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">width</span> <span class="nv">pixels-per-char-width</span><span class="p">))</span>
                    <span class="p">(</span><span class="nb">floor</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">height</span> <span class="nv">pixels-per-char-height</span><span class="p">)))))</span>
</pre></div>


<p>Next, a function that uses the above to set the frame size to exactly fit the left half of the screen. Note that the <code>excess-...</code> variables account for things like the menu bar, the dock or the task bar so you might have to adapt these values to your particular windowing environment. The values given here work for dockless OSX.</p>
<div class="codehilite"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">use-left-half-screen</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">excess-width</span> <span class="mi">32</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">excess-height</span> <span class="mi">48</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">half-screen-width</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nv">x-display-pixel-width</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">excess-width</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">screen-height</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nv">x-display-pixel-height</span><span class="p">)</span> <span class="nv">excess-height</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">set-frame-pixel-size</span> <span class="p">(</span><span class="nv">selected-frame</span><span class="p">)</span> <span class="nv">half-screen-width</span> <span class="nv">screen-height</span><span class="p">)))</span>
</pre></div>


<p>Finally, when Emacs starts up, make it use half the screen. Just how I like it!</p>
<div class="codehilite"><pre><span class="p">(</span><span class="k">if</span> <span class="nv">window-system</span>
    <span class="p">(</span><span class="nv">use-left-half-screen</span><span class="p">))</span>
</pre></div>


<h2>Make shell split windows auto-resize</h2>
<p>Usually when you open a new split window in Emacs, it takes up half the frame. For some kinds of windows, I like them to be smaller. So here is a little snippet that shrinks some kinds of windows to 15 lines of height.</p>
<div class="codehilite"><pre><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;window-configuration-change-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
            <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">string-equal</span> <span class="p">(</span><span class="nv">buffer-name</span><span class="p">)</span> <span class="s">&quot;*Python*&quot;</span><span class="p">)</span>
                      <span class="p">(</span><span class="nb">string-equal</span> <span class="p">(</span><span class="nv">buffer-name</span><span class="p">)</span> <span class="s">&quot;*eshell*&quot;</span><span class="p">)</span>
                      <span class="p">(</span><span class="nb">string-equal</span> <span class="p">(</span><span class="nv">buffer-name</span><span class="p">)</span> <span class="s">&quot;*tex-shell*&quot;</span><span class="p">))</span>
              <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eq</span> <span class="p">(</span><span class="nv">window-height</span><span class="p">)</span> <span class="mi">15</span><span class="p">))</span>
                  <span class="p">(</span><span class="nv">enlarge-window</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">15</span> <span class="p">(</span><span class="nv">window-height</span><span class="p">)))))))</span>
</pre></div>


<h2>Create a new line above/below the current one</h2>
<p>There is one feature of Vim that I really missed: <code>o</code>/<code>O</code>, which 'opens' a new line above or below the current one without changing the current line.</p>
<div class="codehilite"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">vi-open-line-above</span> <span class="p">()</span>
  <span class="s">&quot;Insert a newline above the current line and put point at beginning.&quot;</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">bolp</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">beginning-of-line</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">newline</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">forward-line</span> <span class="mi">-1</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">indent-according-to-mode</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">vi-open-line-below</span> <span class="p">()</span>
  <span class="s">&quot;Insert a newline below the current line and put point at beginning.&quot;</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">eolp</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">end-of-line</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">newline-and-indent</span><span class="p">))</span>

<span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-o&quot;</span><span class="p">)</span> <span class="ss">&#39;vi-open-line-below</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;M-o&quot;</span><span class="p">)</span> <span class="ss">&#39;vi-open-line-above</span><span class="p">)</span>
</pre></div>


<h2>When editing LaTeX, show PDF output in Emacs</h2>
<p>Emacs provides an awesome mode for editing LaTeX files. But isn't it sad that you always have to leave Emacs for viewing the PDF? Well, not any more.</p>
<p>This function will open or refresh a split window with the generated PDF file in it. Thus, when I edit LaTeX, I will hit C-c C-c to compile, then C-c C-v to see the PDF. All that without having to leave the LaTeX file.</p>
<div class="codehilite"><pre><span class="c1">;; open/show pdf file within Emacs using doc-view-mode</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">open-show-pdf</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">tex-buffer-name</span> <span class="p">(</span><span class="nv">buffer-name</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">pdf-buffer-name</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">TeX-master-file</span><span class="p">)</span> <span class="s">&quot;.pdf&quot;</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">get-buffer</span> <span class="nv">pdf-buffer-name</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="nv">pdf-buffer-name</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">find-file-other-window</span> <span class="nv">pdf-buffer-name</span><span class="p">))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eq</span> <span class="nv">major-mode</span> <span class="ss">&#39;doc-view-mode</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">doc-view-mode</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">doc-view-revert-buffer</span> <span class="no">t</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="nv">tex-buffer-name</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;LaTeX-mode-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
            <span class="p">(</span><span class="nv">define-key</span> <span class="nv">LaTeX-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-c C-v&quot;</span><span class="p">)</span> <span class="ss">&#39;open-show-pdf</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">visual-line-mode</span> <span class="no">t</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">turn-on-reftex</span><span class="p">))</span>
          <span class="no">t</span><span class="p">)</span>
</pre></div></div>
	
        <hr>
    	   
        <h2>Comments</h2>
	
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="paperflyer">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>

	
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'bastibe'; 

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>

        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="./archives.html">Archives</a>
                <li><a href="./tags.html">Tags</a>
                <li><a href="./" rel="alternate">Atom feed</a></li>
                
                <li><a href="./feeds/all.rss.xml" rel="alternate">RSS feed</a></li>
                
            </ul>
            </div>


            
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                
                <li><a href="./category/all.html">all</a></li>
                                   
            </ul>
            </div>
            


            


            
            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                
                <li><a href="http://twitter.com/paperflyer">twitter</a></li>
                
                <li><a href="http://github.com/bastibe">github</a></li>
                
            </ul>
            </div>
            </div>
            

        </div>  
    </div> 
    </div> 

<footer>
<br />
<p><a href=".">Bastis Scratchpad On The Internet</a> &copy; Bastian Bechtold 2012</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>


<a href="http://github.com/bastibe/"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
 
</body>
</html>